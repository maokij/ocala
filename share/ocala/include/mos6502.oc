// -*- mode: ocala; -*-
include "noarch.oc"

////////////////////////////////////////////////////////////
// return macros
////////////////////////////////////////////////////////////
macro return(call: _) {
    if use?(%&call) {
        tco %=call
    } else {
        RTS
    }
}

////////////////////////////////////////////////////////////
// goto macros
////////////////////////////////////////////////////////////
macro goto(addr) {
    JMP [%=addr]
}

macro goto-if(cond addr) {
    $(%=addr) -jump-if %=cond
}

////////////////////////////////////////////////////////////
// while macros
////////////////////////////////////////////////////////////
macro while(cond) {
    $(_BEG) -jump-if %=cond
}

macro while/X-() {
    DEX
    BNE _BEG
}

macro while/Y-() {
    DEY
    BNE _BEG
}

////////////////////////////////////////////////////////////
// misc macros
////////////////////////////////////////////////////////////
macro outw(addr a b) {
    @%=a -> [%=addr]
    @%=b -> [%=addr]
}

macro set-carry() {
    SEC
}

macro clear-carry() {
    CLC
}

macro clear-over() {
    CLV
}
